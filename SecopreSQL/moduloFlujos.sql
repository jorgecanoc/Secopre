/*modulo de flujos, configuracion de flujo de movimientos*/

INSERT INTO SECOPRE.USER
(AVATAR, ACTIVE, EMAIL, HAS_CHAT_ACTIVE, NICKNAME, PASSWORD, USERNAME)
VALUES
('pepgonzalez.png',1,'pepegonzalez.hdz@gmail.com', 1, 'pepgonzalez', '$2a$10$wvXkMdLjP3k.XFUeo9zHXORpU7DLCjeqgNGUuEIrcOsfEq5ZJmCvC', 'pepgonzalez');

-- role capturista

INSERT INTO SECOPRE.ROLE
(ACTIVE, ROLENAME)
VALUES
(1, 'ROLE_CAPTURIST');

INSERT INTO SECOPRE.USER_ROLE
(USER_ID, ROLE_ID)
VALUES
(1,-1);

-- menus para alta y listado de tramites

INSERT INTO SECOPRE.menu
(ACTIVE,CSSCLASS, DESCRIPTION, JSFUNCTION, NAME, MENU_ORDER)
VALUES
(1, 'icon-home', 'Módulo de Trámites', 'javascript:void(0);', 'Trámites', 6);

INSERT INTO SECOPRE.menu
(ACTIVE,CSSCLASS, DESCRIPTION, JSFUNCTION, NAME, MENU_ORDER, PARENT_ID)
VALUES
(1, 'icon-home', 'Nuevo Tramite', 'javascript:void(0);', 'Nuevo Trámite', 7, 6);

INSERT INTO SECOPRE.menu
(ACTIVE,CSSCLASS, DESCRIPTION, JSFUNCTION, NAME, MENU_ORDER, PARENT_ID)
VALUES
(1, 'icon-home', 'Mis Tramite', 'javascript:void(0);', 'Mis Trámites', 8, 6);

-- creacion de paths para tramites

INSERT INTO SECOPRE.PATH
(ACTIVE, PUBLIC_ACCESS, URL, MENU_ID)
VALUES
(1, 0, 'auth/tram', 6),
(1, 0, 'auth/tram/add', 7),
(1, 0, 'auth/tram/list', 8);

-- permisos y roles de permisos

INSERT INTO SECOPRE.PERMISSION
(ACTIVE, NAME, PATH_ID)
VALUES
(1, 'TRAM_CONF',5),
(1, 'TRAM_ADD',6),
(1,'TRAM_LIST',7);

INSERT INTO SECOPRE.ROLE_PERMISSION
(ROLE_ID, PERMISSION_ID)
VALUES
(1,6),
(1,7),
(1,8);
   
   
UPDATE SECOPRE.MENU
SET JSFUNCTION = 'sendRequestJQ(\'auth/tram/add\',\'dashboard\',\'TramiteHelper.initTramitePage()\');'
WHERE ID = 7;

UPDATE SECOPRE.USER
SET AVATAR = 'pepgonzalez.jpg'
where id = 1;

commit;



/*--------------------------------------------------------------------------------------------------------*/
-- creacion de tablas 

-- TABLA DE ETAPAS
CREATE TABLE SECOPRE.STAGE(
	ID BIGINT(20) NOT NULL PRIMARY KEY,
	DESCRIPTION VARCHAR(255) NOT NULL,
	LAST_UPDATE DATE,
	ACTIVE BIT(1) DEFAULT 1
);

--TABLA DE CONFIGURACION DE ETAPAS

CREATE TABLE SECOPRE.STAGE_CONFIG(
	ID BIGINT(20) NOT NULL PRIMARY KEY,
	STAGE_ID BIGINT(20) NOT NULL,
	PATH_ID BIGINT(20) NOT NULL,
	IS_CAPTURE BIT(1) NOT NULL,
	IS_AUTHORIZATION BIT(1) NOT NULL,
	CAPTURE_FORM VARCHAR(255),
	LAST_UPDATE DATE,
	ACTIVE BIT(1) DEFAULT 1
);

ALTER TABLE SECOPRE.STAGE_CONFIG
	ADD CONSTRAINT FK_STG_CFG_STG
 	FOREIGN KEY(STAGE_ID) REFERENCES SECOPRE.STAGE(ID);
 	
ALTER TABLE SECOPRE.STAGE_CONFIG
	ADD CONSTRAINT FK_STG_CFG_PATH
 	FOREIGN KEY(PATH_ID) REFERENCES SECOPRE.PATH(ID);
 	
-- TABLA DE FLUJO
CREATE TABLE SECOPRE.WORKFLOW(
	ID BIGINT(20) NOT NULL PRIMARY KEY,
	DESCRIPTION VARCHAR(255) NOT NULL,
	FIRST_STAGE_CFG BIGINT(20) NOT NULL,
	LAST_UPDATE DATE,
	ACTIVE BIT(1) DEFAULT 1
);

ALTER TABLE SECOPRE.WORKFLOW
	ADD CONSTRAINT FK_WF_CFG_STG
 	FOREIGN KEY(FIRST_STAGE_CFG) REFERENCES SECOPRE.STAGE_CONFIG(ID);
 	

-- TABLA DE CODIGOS DE TRANSICION
CREATE TABLE SECOPRE.WORKFLOW_CONFIG_CODE(
	ID BIGINT(20) NOT NULL PRIMARY KEY,
	CODE VARCHAR(255) NOT NULL,
	DESCRIPTION VARCHAR(255),
	LAST_UPDATE DATE,
	ACTIVE BIT(1) DEFAULT 1
);

ALTER TABLE SECOPRE.WORKFLOW_CONFIG_CODE
ADD UNIQUE INDEX IDX_CODE (CODE);

-- TABLA DE ESTADO

CREATE TABLE SECOPRE.STATUS(
	ID BIGINT(20) NOT NULL PRIMARY KEY,
	DESCRIPTION VARCHAR(255),
	LAST_UPDATE DATE,
	ACTIVE BIT(1) DEFAULT 1
);


DROP TABLE SECOPRE.WORKFLOW_CONFIG;

-- TABLA DE CONFIGURACION DE FLUJOS
CREATE TABLE SECOPRE.WORKFLOW_CONFIG(
	ID BIGINT(20) NOT NULL PRIMARY KEY,
	WORKFLOW_ID BIGINT(20) NOT NULL,
	STAGE_CONFIG_ID BIGINT(20) NOT NULL,
	WF_CFG_CODE VARCHAR(255) NOT NULL,
	NEXT_STAGE_CONFIG BIGINT(20) NOT NULL,
	STATUS_ID BIGINT(20) NOT NULL,
	LAST_UPDATE DATE,
	ACTIVE BIT(1) DEFAULT 1
);

ALTER TABLE SECOPRE.WORKFLOW_CONFIG
	ADD CONSTRAINT FK_WF_CFG_STG_CFG
 	FOREIGN KEY(STAGE_CONFIG_ID) REFERENCES SECOPRE.STAGE_CONFIG(ID);
 	
ALTER TABLE SECOPRE.WORKFLOW_CONFIG
	ADD CONSTRAINT FK_WF_CFG_NXT_STG
 	FOREIGN KEY(NEXT_STAGE_CONFIG) REFERENCES SECOPRE.STAGE_CONFIG(ID);

ALTER TABLE SECOPRE.WORKFLOW_CONFIG
	ADD CONSTRAINT FK_WF_CFG_CODE
 	FOREIGN KEY(WF_CFG_CODE) REFERENCES SECOPRE.WORKFLOW_CONFIG_CODE(CODE);

ALTER TABLE SECOPRE.WORKFLOW_CONFIG
	ADD CONSTRAINT FK_WF_CFG_STATUS
 	FOREIGN KEY(STATUS_ID) REFERENCES SECOPRE.STATUS(ID);
 	
ALTER TABLE SECOPRE.WORKFLOW_CONFIG
	ADD CONSTRAINT FK_WF_CFG_WF
 	FOREIGN KEY(WORKFLOW_ID) REFERENCES SECOPRE.WORKFLOW(ID);

-- TABLA DE FORMALIDADES
CREATE TABLE SECOPRE.FORMALITY(
	ID BIGINT(20) NOT NULL,
	DESCRIPTION VARCHAR(255) NOT NULL,
	WORKFLOW_ID BIGINT(20) NOT NULL,
	LAST_UPDATE DATE,
	ACTIVE BIT(1) DEFAULT 1
);

ALTER TABLE SECOPRE.FORMALITY
	ADD CONSTRAINT FK_FORM_WF
 	FOREIGN KEY(WORKFLOW_ID) REFERENCES SECOPRE.WORKFLOW(ID);
 	
-- TABLA DE TRAMITES CREADOS
CREATE TABLE SECOPRE.REQUEST(
	ID BIGINT(20) NOT NULL,
	FIRST_NAME VARCHAR(255),
	PARENT_LAST_NAME VARCHAR(255),
	MOTHER_LAST_NAME VARCHAR(255),
	LAST_UPDATE DATE,
	ACTIVE BIT(1) DEFAULT 1
);

-- TABLA DE CONFIGURACION DEL TRAMITE
CREATE TABLE SECOPRE.REQUEST_CONFIG(
	REQUEST_ID BIGINT(20) NOT NULL,
	FORMALITY_ID BIGINT(20) NOT NULL,
	WORKFLOW_ID BIGINT(20) NOT NULL,
	LAST_UPDATE DATE,
	ACTIVE BIT(1) DEFAULT 1
);
 	
ALTER TABLE SECOPRE.REQUEST_CONFIG
	ADD CONSTRAINT REQ_CFG_WF
 	FOREIGN KEY(WORKFLOW_ID) REFERENCES SECOPRE.WORKFLOW(ID);
 	
 	
-- TABLA DE RELACION DE ETAPAS Y ROLES
CREATE TABLE SECOPRE.STAGE_CONFIG_ROLE(
	STAGE_CONFIG_ID BIGINT(20) NOT NULL,
	ROLE_ID BIGINT(20) NOT NULL,
	LAST_UPDATE DATE,
	ACTIVE BIT(1) DEFAULT 1
);

ALTER TABLE SECOPRE.STAGE_CONFIG_ROLE
	ADD CONSTRAINT STG_CFG_RL_ROLE
 	FOREIGN KEY(ROLE_ID) REFERENCES SECOPRE.ROLE(ID);

 ALTER TABLE SECOPRE.STAGE_CONFIG_ROLE
	ADD CONSTRAINT STG_CFG_RL_STGCFG
 	FOREIGN KEY(STAGE_CONFIG_ID) REFERENCES SECOPRE.STAGE_CONFIG(ID);

ALTER TABLE SECOPRE.STAGE_CONFIG_ROLE
ADD UNIQUE INDEX IDX_STG_CFG_ROLE (ROLE_ID, STAGE_CONFIG_ID);
 	
-- creacion de etapas

INSERT INTO SECOPRE.STAGE
(ID, DESCRIPTION, LAST_UPDATE)
VALUES
(1, 'Captura Básica', SYSDATE());

INSERT INTO SECOPRE.STAGE
(ID, DESCRIPTION, LAST_UPDATE)
VALUES
(2, 'Captura Completa', SYSDATE());

INSERT INTO SECOPRE.STAGE
(ID, DESCRIPTION, LAST_UPDATE)
VALUES
(3, 'Autorización', SYSDATE());

INSERT INTO SECOPRE.STAGE
(ID, DESCRIPTION, LAST_UPDATE)
VALUES
(4, 'Tramite finalizado', SYSDATE());

INSERT INTO SECOPRE.STAGE
(ID, DESCRIPTION, LAST_UPDATE)
VALUES
(5, 'Tramite Cancelado', SYSDATE());

--paths de captura y autorizacion
INSERT INTO SECOPRE.PATH
(ID, ACTIVE, PUBLIC_ACCESS, URL)
VALUES
(8, 1, 0, 'auth/wf/capture');

INSERT INTO SECOPRE.PATH
(ID, ACTIVE, PUBLIC_ACCESS, URL)
VALUES
(9, 1, 0, 'auth/wf/authorization');

INSERT INTO SECOPRE.PATH
(ID, ACTIVE, PUBLIC_ACCESS, URL)
VALUES
(10, 1, 0, 'auth/wf/finish');


-- configuracion de etapas

INSERT INTO SECOPRE.STAGE_CONFIG
(ID, STAGE_ID, PATH_ID, IS_CAPTURE, IS_AUTHORIZATION, CAPTURE_FORM, LAST_UPDATE)
VALUES
(1, 1, 8, 1, 0, 'basic', SYSDATE());

INSERT INTO SECOPRE.STAGE_CONFIG
(ID, STAGE_ID, PATH_ID, IS_CAPTURE, IS_AUTHORIZATION, CAPTURE_FORM, LAST_UPDATE)
VALUES
(2, 2, 8, 1, 0, 'movements', SYSDATE());

INSERT INTO SECOPRE.STAGE_CONFIG
(ID, STAGE_ID, PATH_ID, IS_CAPTURE, IS_AUTHORIZATION, LAST_UPDATE)
VALUES
(3, 3, 9, 0, 1,SYSDATE());

INSERT INTO SECOPRE.STAGE_CONFIG
(ID, STAGE_ID, PATH_ID, IS_CAPTURE, IS_AUTHORIZATION, LAST_UPDATE)
VALUES
(4, 3, 9, 0, 1,SYSDATE());

INSERT INTO SECOPRE.STAGE_CONFIG
(ID, STAGE_ID, PATH_ID, IS_CAPTURE, IS_AUTHORIZATION, LAST_UPDATE)
VALUES
(5, 3, 9, 0, 1,SYSDATE());

INSERT INTO SECOPRE.STAGE_CONFIG
(ID, STAGE_ID, PATH_ID, IS_CAPTURE, IS_AUTHORIZATION, LAST_UPDATE)
VALUES
(6, 3, 9, 0, 1,SYSDATE());

INSERT INTO SECOPRE.STAGE_CONFIG
(ID, STAGE_ID, PATH_ID, IS_CAPTURE, IS_AUTHORIZATION, LAST_UPDATE)
VALUES
(7, 4, 10, 0, 0, SYSDATE());

INSERT INTO SECOPRE.STAGE_CONFIG
(ID, STAGE_ID, PATH_ID, IS_CAPTURE, IS_AUTHORIZATION, LAST_UPDATE)
VALUES
(8, 5, 10, 0, 0, SYSDATE());

-- CONFIGURACION DE CODIGOS DE TRANSICION

INSERT INTO SECOPRE.WORKFLOW_CONFIG_CODE
(ID, CODE, DESCRIPTION, LAST_UPDATE)
VALUES
(1, 'SOLPEND', 'Solicitud Pendiente, guarda con validaciones minimas, no avanza de etapa', SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG_CODE
(ID, CODE, DESCRIPTION, LAST_UPDATE)
VALUES
(2, 'SOLCOMP', 'Solicitud Completa, guarda con todas las validaciones, avanza de etapa', SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG_CODE
(ID, CODE, DESCRIPTION, LAST_UPDATE)
VALUES
(3, 'SIGFIRMA', 'visto bueno de usuario correspondiente a etapa, avanza a siguiente autorizacion', SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG_CODE
(ID, CODE, DESCRIPTION, LAST_UPDATE)
VALUES
(4, 'REGRESAR', 'regresa el tramite de etapa', SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG_CODE
(ID, CODE, DESCRIPTION, LAST_UPDATE)
VALUES
(5, 'CONTINUAR', 'avanza de etapa, si el vobo es de superusuario', SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG_CODE
(ID, CODE, DESCRIPTION, LAST_UPDATE)
VALUES
(6, 'CANCELAR', 'Cancelar el tramite', SYSDATE());

-- CATALOGO DE ESTATUS

INSERT INTO SECOPRE.STATUS
(ID, DESCRIPTION, LAST_UPDATE)
VALUES
(1, 'Captura de Información Básica', SYSDATE());

INSERT INTO SECOPRE.STATUS
(ID, DESCRIPTION, LAST_UPDATE)
VALUES
(2, 'Captura de Información Completa', SYSDATE());

INSERT INTO SECOPRE.STATUS
(ID, DESCRIPTION, LAST_UPDATE)
VALUES
(3, 'Autorización de Jefe', SYSDATE());

INSERT INTO SECOPRE.STATUS
(ID, DESCRIPTION, LAST_UPDATE)
VALUES
(4, 'Autorización de Magistrado', SYSDATE());

INSERT INTO SECOPRE.STATUS
(ID, DESCRIPTION, LAST_UPDATE)
VALUES
(5, 'Autorización de Asesor', SYSDATE());

INSERT INTO SECOPRE.STATUS
(ID, DESCRIPTION, LAST_UPDATE)
VALUES
(6, 'Autorización de Administrador', SYSDATE());

INSERT INTO SECOPRE.STATUS
(ID, DESCRIPTION, LAST_UPDATE)
VALUES
(7, 'Trámite finalizado', SYSDATE());

INSERT INTO SECOPRE.STATUS
(ID, DESCRIPTION, LAST_UPDATE)
VALUES
(8, 'Trámite Cancelado', SYSDATE());

-- flujo

INSERT INTO SECOPRE.WORKFLOW
(ID, DESCRIPTION, FIRST_STAGE_CFG, LAST_UPDATE)
VALUES
(1, 'Flujo de Movimientos', 1, sysdate());

-- configuracion del flujo

INSERT INTO SECOPRE.WORKFLOW_CONFIG
(ID, WORKFLOW_ID, STAGE_CONFIG_ID, WF_CFG_CODE, NEXT_STAGE_CONFIG, STATUS_ID, LAST_UPDATE)
VALUES
(1, 1, 1, 'SOLPEND', 1, 1, SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG
(ID, WORKFLOW_ID, STAGE_CONFIG_ID, WF_CFG_CODE, NEXT_STAGE_CONFIG, STATUS_ID, LAST_UPDATE)
VALUES
(2, 1, 1, 'SOLCOMP', 2, 2, SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG
(ID, WORKFLOW_ID, STAGE_CONFIG_ID, WF_CFG_CODE, NEXT_STAGE_CONFIG, STATUS_ID, LAST_UPDATE)
VALUES
(3, 1, 2, 'SOLPEND', 2, 2, SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG
(ID, WORKFLOW_ID, STAGE_CONFIG_ID, WF_CFG_CODE, NEXT_STAGE_CONFIG, STATUS_ID, LAST_UPDATE)
VALUES
(4, 1, 2, 'SOLCOMP', 3, 3, SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG
(ID, WORKFLOW_ID, STAGE_CONFIG_ID, WF_CFG_CODE, NEXT_STAGE_CONFIG, STATUS_ID, LAST_UPDATE)
VALUES
(5, 1, 3, 'SIGFIRMA', 4, 4, SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG
(ID, WORKFLOW_ID, STAGE_CONFIG_ID, WF_CFG_CODE, NEXT_STAGE_CONFIG, STATUS_ID, LAST_UPDATE)
VALUES
(6, 1, 3, 'REGRESAR', 2, 2, SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG
(ID, WORKFLOW_ID, STAGE_CONFIG_ID, WF_CFG_CODE, NEXT_STAGE_CONFIG, STATUS_ID, LAST_UPDATE)
VALUES
(7, 1, 3, 'CONTINUAR', 7, 7, SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG
(ID, WORKFLOW_ID, STAGE_CONFIG_ID, WF_CFG_CODE, NEXT_STAGE_CONFIG, STATUS_ID, LAST_UPDATE)
VALUES
(8, 1, 3, 'CANCELAR', 8, 8, SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG
(ID, WORKFLOW_ID, STAGE_CONFIG_ID, WF_CFG_CODE, NEXT_STAGE_CONFIG, STATUS_ID, LAST_UPDATE)
VALUES
(9, 1, 4, 'SIGFIRMA', 5, 5, SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG
(ID, WORKFLOW_ID, STAGE_CONFIG_ID, WF_CFG_CODE, NEXT_STAGE_CONFIG, STATUS_ID, LAST_UPDATE)
VALUES
(10, 1, 4, 'REGRESAR', 3, 3, SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG
(ID, WORKFLOW_ID, STAGE_CONFIG_ID, WF_CFG_CODE, NEXT_STAGE_CONFIG, STATUS_ID, LAST_UPDATE)
VALUES
(11, 1, 4, 'CONTINUAR', 7, 7, SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG
(ID, WORKFLOW_ID, STAGE_CONFIG_ID, WF_CFG_CODE, NEXT_STAGE_CONFIG, STATUS_ID, LAST_UPDATE)
VALUES
(12, 1, 4, 'CANCELAR', 7, 8, SYSDATE());
--
INSERT INTO SECOPRE.WORKFLOW_CONFIG
(ID, WORKFLOW_ID, STAGE_CONFIG_ID, WF_CFG_CODE, NEXT_STAGE_CONFIG, STATUS_ID, LAST_UPDATE)
VALUES
(13, 1, 5, 'SIGFIRMA', 6, 6, SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG
(ID, WORKFLOW_ID, STAGE_CONFIG_ID, WF_CFG_CODE, NEXT_STAGE_CONFIG, STATUS_ID, LAST_UPDATE)
VALUES
(14, 1, 5, 'REGRESAR', 4, 4, SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG
(ID, WORKFLOW_ID, STAGE_CONFIG_ID, WF_CFG_CODE, NEXT_STAGE_CONFIG, STATUS_ID, LAST_UPDATE)
VALUES
(15, 1, 5, 'CONTINUAR', 7, 7, SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG
(ID, WORKFLOW_ID, STAGE_CONFIG_ID, WF_CFG_CODE, NEXT_STAGE_CONFIG, STATUS_ID, LAST_UPDATE)
VALUES
(16, 1, 5, 'CANCELAR', 8, 8, SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG
(ID, WORKFLOW_ID, STAGE_CONFIG_ID, WF_CFG_CODE, NEXT_STAGE_CONFIG, STATUS_ID, LAST_UPDATE)
VALUES
(17, 1, 6, 'REGRESAR', 5, 5, SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG
(ID, WORKFLOW_ID, STAGE_CONFIG_ID, WF_CFG_CODE, NEXT_STAGE_CONFIG, STATUS_ID, LAST_UPDATE)
VALUES
(18, 1, 6, 'CONTINUAR', 7, 7, SYSDATE());

INSERT INTO SECOPRE.WORKFLOW_CONFIG
(ID, WORKFLOW_ID, STAGE_CONFIG_ID, WF_CFG_CODE, NEXT_STAGE_CONFIG, STATUS_ID, LAST_UPDATE)
VALUES
(19, 1, 6, 'CANCELAR', 8, 8, SYSDATE());

-- rol de prueba

INSERT INTO SECOPRE.ROLE
(ID, ACTIVE, ROLENAME)
VALUES
(2, 1, 'ROLE_ADMIN');

--roles

INSERT INTO SECOPRE.STAGE_CONFIG_ROLE
(STAGE_CONFIG_ID, ROLE_ID, LAST_UPDATE)
VALUES
(1,1,SYSDATE());

INSERT INTO SECOPRE.STAGE_CONFIG_ROLE
(STAGE_CONFIG_ID, ROLE_ID, LAST_UPDATE)
VALUES
(2,1,SYSDATE());

INSERT INTO SECOPRE.STAGE_CONFIG_ROLE
(STAGE_CONFIG_ID, ROLE_ID, LAST_UPDATE)
VALUES
(3,1,SYSDATE());

INSERT INTO SECOPRE.STAGE_CONFIG_ROLE
(STAGE_CONFIG_ID, ROLE_ID, LAST_UPDATE)
VALUES
(4,1,SYSDATE());

INSERT INTO SECOPRE.STAGE_CONFIG_ROLE
(STAGE_CONFIG_ID, ROLE_ID, LAST_UPDATE)
VALUES
(5,1,SYSDATE());

INSERT INTO SECOPRE.STAGE_CONFIG_ROLE
(STAGE_CONFIG_ID, ROLE_ID, LAST_UPDATE)
VALUES
(6,1,SYSDATE());

-- formality

INSERT INTO SECOPRE.FORMALITY
(ID, DESCRIPTION, WORKFLOW_ID, LAST_UPDATE)
VALUES
(1, 'Trámite de Movimientos', 1, sysdate());

-- con este query obtienes todo el flujo de un tramite
/*
SELECT CT.ID,
	 	CT.WORKFLOW_ID,
	 	CT.STAGE_CONFIG_ID,
	 	P1.URL,
	 	CT.WF_CFG_CODE,
	 	CT.NEXT_STAGE_CONFIG,
	 	P2.URL,
	 	CT.STATUS_ID,
	 	S.DESCRIPTION,
	 	CT.LAST_UPDATE,
	 	CT.ACTIVE
  FROM SECOPRE.WORKFLOW_CONFIG CT,
  	   SECOPRE.STAGE_CONFIG SC1,
  	   SECOPRE.PATH P1,
  	   SECOPRE.STAGE_CONFIG SC2,
  	   SECOPRE.PATH P2,
  	   SECOPRE.STATUS S
 WHERE CT.WORKFLOW_ID = 1
   AND CT.STAGE_CONFIG_ID = SC1.ID
   AND SC1.PATH_ID = P1.ID
   AND CT.NEXT_STAGE_CONFIG = SC2.ID
   AND SC2.PATH_ID = P2.ID
   AND CT.STATUS_ID = S.ID
   ORDER BY 1
*/

-- con este query obtienes todos los tramites de los cuales puedes crear en funcion de tus roles
/*
SELECT DISTINCT(T.ID), T.F_DESC FROM (
SELECT F.ID,
	   F.DESCRIPTION F_DESC,
	   F.WORKFLOW_ID,
	   W.DESCRIPTION WF_DESC,
	   W.FIRST_STAGE_CFG,
	   SCR.ROLE_ID,
	   R.ROLENAME
  FROM SECOPRE.FORMALITY F,
  	   SECOPRE.WORKFLOW W,
  	   SECOPRE.STAGE_CONFIG_ROLE SCR,
  	   SECOPRE.ROLE R,
  	   SECOPRE.USER_ROLE UR
 WHERE F.WORKFLOW_ID = W.ID
   AND W.FIRST_STAGE_CFG = SCR.STAGE_CONFIG_ID
   AND SCR.ROLE_ID = R.ID
   AND R.ID = UR.ROLE_ID
   AND UR.USER_ID = 1
) T
*/  

-- /*ALTER GRUPO DE AUTORIZACIONES*/
CREATE TABLE SECOPRE.AUTHORIZATION(
	ID BIGINT(20) NOT NULL PRIMARY KEY,
	DESCRIPTION VARCHAR(255) NOT NULL,
	SUPER_USER_ROLE BIGINT(20) NOT NULL,
	LAST_UPDATE DATE,
	ACTIVE BIT(1) DEFAULT 1
);

ALTER TABLE SECOPRE.AUTHORIZATION
	ADD CONSTRAINT FK_AUTH_ROLE
 	FOREIGN KEY(SUPER_USER_ROLE) REFERENCES SECOPRE.ROLE(ID);
	
CREATE TABLE SECOPRE.AUTHORIZATION_CONFIG(
	ID BIGINT(20) NOT NULL PRIMARY KEY,
	STAGE_CONFIG_ID BIGINT(20) NOT NULL,
	EMPLOYMENT_ID BIGINT(20) NOT NULL,
	LAST_UPDATE DATE,
	ACTIVE BIT(1) DEFAULT 1
);

ALTER TABLE SECOPRE.AUTHORIZATION_CONFIG
	ADD CONSTRAINT FK_AUTH_CFG_STG_CFG
 	FOREIGN KEY(STAGE_CONFIG_ID) REFERENCES SECOPRE.STAGE_CONFIG(ID);
	
ALTER TABLE SECOPRE.AUTHORIZATION_CONFIG
	ADD CONSTRAINT FK_AUTH_CFG_EMP
 	FOREIGN KEY(EMPLOYMENT_ID) REFERENCES SECOPRE.EMPLOYMENT(ID);
	
-- SE CARGAN LOS EMPLEOS CORRESPONDIENTES A LA AUTHORIZACION
-- SE CARGAN LAS CONFIGURACIONES DE AUTORIZACION POR ETAPAS
-- SE CUELGA EL GRUPO DE AUTORIZACION AL TRAMITE

